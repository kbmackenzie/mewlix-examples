yarn ball spec

from dice.parser takes Parser

mew suite! = ğŸ“¦ [
  tests:    0,
  failures: 0,
]

ğŸ± expect(x, y)
  suite.tests = suite.tests + 1
  pounce when x == y; run away; ~meow

  meow :3'test failed: [x] != [y]'
  suite.failures = suite.failures + 1
~meow

ğŸ± run_test(test)
  mew parser! = new Parser(test.input)
  mew expr!   = parser.parse()
  do expect <- expr.purr(), test.expected
~meow

mew tests! = [
  ğŸ“¦ [ input: '1d20 + 1d4'        , expected: '(1d20 + 1d4)'        ],
  ğŸ“¦ [ input: '1d20 + 1d4 + 1'    , expected: '((1d20 + 1d4) + 1)'  ],
  ğŸ“¦ [ input: '3d8 + 2d6 + 5'     , expected: '((3d8 + 2d6) + 5)'   ],
  ğŸ“¦ [ input: '12d4 - 10'         , expected: '(12d4 - 10)'         ],
] |> std.reverse

chase after test in tests!!!
  do run_test <- test
~meow

pounce when suite.failures == 0
  meow 'All tests passed.'
else hiss 
  mew successes = suite.tests - suite.failures
  meow :3'[suite.tests] tests run: [suite.failures] failures, [successes] successes'
~meow
